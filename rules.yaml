# General Settings

- message: redpanda.developer_mode is enabled
  severity: info
  expression: redpanda.developer_mode == true

- message: topic auto creation is enabled and developer mode is disabled
  severity: warning
  expression: >
    redpanda.auto_create_topics_enabled == true &&
    redpanda.developer_mode == false

- message: topic auto creation is enabled
  severity: info
  expression: redpanda.auto_create_topics_enabled == true

# Performance Tuning

- message: redpanda.topic_partitions_per_shard > 1000
  severity: warning
  expression: redpanda.topic_partitions_per_shard > 1000

# Security Rules (TLS / SASL / etc)

- message: kafka_api_tls.require_client_auth is true, but kafka_enable_authorization is false
  severity: info
  expression: >
    any(redpanda.kafka_api_tls, {.require_client_auth == true}) &&
    redpanda.kafka_enable_authorization == false

- message: sasl without tls
  severity: warning
  expression: >
    redpanda.enable_sasl == true &&
    any(redpanda.kafka_api_tls, {.enabled == false})